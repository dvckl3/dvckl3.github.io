---
title: 'ECDSA Cracking Methods'
date: 2025-06-05
categories: [ctf]
tags: [Crypto]     
published: true
description: "Chữ kí số dựa trên Elliptic Curve"
---
## ECDSA's Scheme
Lược đồ chữ kí số ECDSA bao gồm các thành phần sau: Đầu tiên là một khóa bí mật $\displaystyle d$ và khóa công khai sẽ được tính bởi $\displaystyle Q=d.G$ trong đó $\displaystyle G$ là generator của elliptic curve có order là $\displaystyle n$.

Như vậy $\displaystyle \left(\text{pk} ,\text{sk}\right) =( d,Q)$

![image](https://github.com/user-attachments/assets/c4ddb00f-de89-4cb2-a52c-709e7bc770ff)


**Tạo chữ kí:**

Với message $\displaystyle ( m)$, mục tiêu của ta là dùng priv key để tạo ra một cặp chữ kí $\displaystyle ( r,s)$. Đầu tiên ta cần sử dụng một nonce $\displaystyle k$ để tính giá trị của 

$$\begin{equation*}
P=kG
\end{equation*}$$

Khi đó ta sẽ lấy 

$$\begin{equation*}
r=P_{x}(\bmod n)
\end{equation*}$$

Tiếp theo ta sẽ tính $\displaystyle s$ như sau

$$\begin{equation*}
s=k^{-1}( e+dr)(\bmod n)
\end{equation*}$$

trong đó $\displaystyle e=H( m)$ với $\displaystyle H$ là một hàm Hash. 

Vậy ta có cặp $\displaystyle ( r,s)$ là chữ kí số của msg $\displaystyle m$. 



**Xác minh chữ kí:**

Để xác minh chữ kí số $\displaystyle ( m,( r,s))$ ta làm như sau:

Ta sẽ tính $\displaystyle e=H( m)$. Sau đó sẽ tính 


$$\begin{gather*}
w=s^{-1}(\bmod n)\\
u_{1} =ew\\
u_{2} =rw
\end{gather*}$$

Sau đó ta sẽ tính 

$$\begin{gather*}
X=u_{1} G+u_{2} Q\\
x=X_{x}(\bmod n)
\end{gather*}$$

và kiểm tra xem $\displaystyle x=r$ thì chữ kí là hợp lệ.



Vì sao ta lại có $\displaystyle x=r?$.



Đầu tiên ta xét 

$$\begin{equation*}
P=kG
\end{equation*}$$

Và $\displaystyle Q=dG$ cho nên 

$$\begin{gather*}
X=u_{1} G+u_{2} Q=u_{1} G+u_{2} dG\\
=( u_{1} +u_{2} d) G
\end{gather*}$$

Vậy ta cần chỉ ra $\displaystyle u_{1} +u_{2} d\equiv k(\bmod n)$. Cụ thể 

$$\begin{gather*}
w=s^{-1}(\bmod n)\\
\Longrightarrow ew+rwd=w( e+rd) =sks^{-1} =k(\bmod n)
\end{gather*}$$

Lưu ý rằng khi làm việc trên đường cong Elliptic thì 

$$\begin{equation*}
aG=bG
\end{equation*}$$

khi và chỉ khi $\displaystyle a\equiv b\bmod G.order()$. Ở đây order là $\displaystyle n$ cho nên ta có điều phải chứng minh.
